C51 COMPILER V9.00   千本樱（改）                                                          12/30/2018 20:31:07 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE 千本樱（改）
OBJECT MODULE PLACED IN 千本樱（改）.OBJ
COMPILER INVOKED BY: C:\0000000\keil4\C51\BIN\C51.EXE 千本樱（改）.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /************************************************************************  
   2          [文件名]  C51音乐程序 
   3          [功能]    通过单片机演奏音乐  
   4          
   5          /**********************************************************************/   
   6          #include <REG52.H>    
   7          #include <INTRINS.H>    
   8          #include "reg52.h"      
   9          typedef unsigned int u16;         //对数据类型进行声明定义
  10          typedef unsigned char u8;
  11          
  12          sbit k1=P3^1;    //定义P31口是k1
  13          
  14          
  15          
  16          sbit Beep =  P1^5; 
  17          
  18          unsigned char n=0;      
  19          unsigned char code music_tab[] ={ 0xff,  
  20          
  21          
  22                  0x1c,0x10,0x1c,0x20,0x20,0x10,
  23                  0x1c,0x10,0x1c,0x20,0x20,0x10,
  24                  0x1c,0x10,0x1c,0x20,0x20,0x10,
  25                  0x1c,0x20,0x18,0x20,
  26          
  27                  0x1c,0x10,0x1c,0x20,0x20,0x10,
  28                  0x1c,0x10,0x1c,0x20,0x20,0x10,
  29                  0x1c,0x20,0x18,0x20,0x15,0x20,0x13,0x20,
  30          
  31                  0x2b,0x10,0x26,0x10,
  32                  0x39,0x08,0x40,0x08,0x39,0x08,0x40,0x08,
  33          
  34                  0x2b,0x10,0x26,0x10,
  35                  0x39,0x08,0x40,0x08,0x39,0x08,0x40,0x08,
  36          
  37                  0x2b,0x10,0x26,0x10,
  38                  0x39,0x08,0x40,0x08,0x39,0x08,0x40,0x08,
  39          
  40                  0x30,0x10,0x33,0x10,0x39,0x10,0x40,0x10,
  41          
  42                  0x2b,0x10,0x26,0x10,
  43                  0x39,0x08,0x40,0x08,0x39,0x08,0x40,0x08,
  44          
  45                  0x2b,0x10,0x26,0x10,
  46                  0x39,0x08,0x40,0x08,0x39,0x08,0x40,0x08,
  47          
  48                  0x2b,0x10,0x26,0x10,0x20,0x10,0x18,0x10,
  49                  0x19,0x08,0x18,0x08,0x19,0x08,0x1c,0x08,
  50                  0x20,0x10,0x26,0x10,
  51          
  52                  0x2b,0x10,0x26,0x10,
  53                  0x39,0x08,0x40,0x08,0x39,0x08,0x40,0x08,
  54          
  55                  0x2b,0x10,0x26,0x10,
C51 COMPILER V9.00   千本樱（改）                                                          12/30/2018 20:31:07 PAGE 2   

  56                  0x39,0x08,0x40,0x08,0x39,0x08,0x40,0x08,
  57          
  58                  0x2b,0x10,0x26,0x10,
  59                  0x39,0x08,0x40,0x08,0x39,0x08,0x40,0x08,
  60          
  61                  0x30,0x10,0x33,0x10,0x39,0x10,0x40,0x10,
  62          
  63          
  64          
  65                  0x39,0x10,
  66                  0x40,0x08,0x39,0x08,0x30,0x10,
  67                  0x39,0x08,0x30,0x08,0x2b,0x10,
  68                  0x2b,0x08,0x26,0x08,0x20,0x08,
  69                  0x18,0x08,0x26,0x08,0x20,0x08,
  70                  0x18,0x10,0x19,0x08,0x18,0x08,
  71                  0x19,0x08,0x1c,0x10,0x20,0x10,
  72                  0x1c,0x10,0x20,0x10,0x1c,0x10,
  73          
  74          
  75          
  76          
  77                  0xff,0xff,0xff,0xff ,
  78          
  79          
  80                  0x00 
  81          };   
  82          
  83          
  84          unsigned char code music_tab1 [] = { 0xff,    0x18,0x08,0x15,0x10,0x13,0x10,
  85                  0x1c,0x08,0x20,0x08,0x1c,0x08,0x20,0x08,
  86                  0x15,0x10,0x13,0x10,
  87                  0x1c,0x08,0x20,0x08,0x1c,0x08,0x20,0x08,
  88                  0x15,0x10,0x13,0x10,
  89                  0x1c,0x08,0x20,0x08,0x1c,0x08,0x20,0x08,                        
  90                  0x18,0x10,0x19,0x10,0x1c,0x10,0x20,0x10,
  91                  0x15,0x10,0x13,0x10,
  92                  0x1c,0x08,0x20,0x08,0x1c,0x08,0x20,0x08,
  93                  0x15,0x10,0x13,0x10,
  94                  0x1c,0x08,0x20,0x08,0x1c,0x08,0x20,0x08,
  95                  0x15,0x10,0x13,0x10,0x10,0x10,0x0c,0x10,
  96                  0x0d,0x08,0x0c,0x08,0x0d,0x08,0x0e,0x08,
  97                  0x10,0x10,0x13,0x10,
  98                  0x15,0x10,0x13,0x10,
  99                  0x1c,0x08,0x20,0x08,0x1c,0x08,0x20,0x08,
 100                  0x15,0x10,0x13,0x10,
 101                  0x1c,0x08,0x20,0x08,0x1c,0x08,0x20,0x08,
 102                  0x15,0x10,0x13,0x10,
 103                  0x1c,0x08,0x20,0x08,0x1c,0x08,0x20,0x08,
 104                  0x18,0x10,0x19,0x10,0x1c,0x10,0x20,0x10,
 105          
 106          
 107                  0x1c,0x10,0x20,0x08,0x1c,0x08,
 108                  0x18,0x10,0x1c,0x08,0x18,0x08,
 109                  0x15,0x10,0x18,0x08,0x15,0x08,
 110                  0x13,0x10,0x10,0x10,
 111          
 112                  0x1c,0x20,0x1c,0x10,0x20,0x10,0x1c,0x40,
 113          
 114          
 115                  0x00}              ;
 116          
 117          
C51 COMPILER V9.00   千本樱（改）                                                          12/30/2018 20:31:07 PAGE 3   

 118          
 119          
 120          
 121          unsigned char code  music_tab2 [] ={    0x1c,0x20,0x1c,0x18,0x20,0x08,
 122                  0x1c,0x10,0x18,0x10,0x15,0x10,0x13,0x10,
 123                  0x1c,0x20,0x1c,0x18,0x20,0x08,
 124                  0x1c,0x10,0x20,0x10,0x26,0x10,0x20,0x10  ,
 125                  0x1c,0x20,0x1c,0x18,0x20,0x08,
 126                  0x1c,0x10,0x18,0x10,0x15,0x10,0x13,0x10,
 127                  0x13,0x20,0x15,0x20,0x18,0x20,0x1c,0x20,
 128          
 129                  0x1c,0x20,0x1c,0x18,0x20,0x08,
 130                  0x1c,0x10,0x18,0x10,0x15,0x10,0x13,0x10,
 131                  0x1c,0x20,0x1c,0x18,0x20,0x08,
 132                  0x1c,0x10,0x20,0x10,0x20,0x10,   0x26,0x10,
 133                  0x1c,0x20,0x1c,0x18,0x20,0x08,
 134                  0x20,0x10,0x1c,0x10,0x18,0x10,0x15,0x10,0x13,0x20,0x15,0x20,0x18,0x20,
 135                  0x1c,0x20,
 136                  0x18,0x20,0x19,0x20,0x1c,0x20,0x20,0x20,
 137                  0x20,0x10,0x1c,0x08,0x20,0x08,
 138                  0x26,0x10,0x2b,0x10,0x26,0x40,
 139                  0x26,0x10,0x20,0x10,0x1c,0x20,0x15,0x20,0x19,0x20,0x18,0x20,0x19,0x10,
 140                  0x20,0x10,0x1c,0x40,
 141                  0x18,0x20,0x19,0x20,0x1c,0x20,0x20,0x20,
 142                  0x20,0x10,0x1c,0x08,0x20,0x08,
 143                  0x26,0x10,0x2b,0x10,0x26,0x20,
 144                  0x26,0x10,0x20,0x10,
 145                  0x1c,0x10,0x1c,0x20,0x1c,0x10,0x18,0x20,0x15,0x20,0x19,0x60,
 146          
 147          
 148                  0x00
 149          };
 150          
 151          
 152          unsigned char code   music_tab3[] ={       0x1c,0x10,0x18,0x10,0x15,0x10,0x15,0x20,0x13,0x10,0x13,0x30,0x13,
             -0x10,
 153                  0x10,0x10,
 154                  0x0e,0x10,0x15,0x10,0x18,0x10,0x13,0x20,
 155                  0x1c,0x10,0x18,0x10,0x15,0x10,0x15,0x20,0x13,0x10,0x13,0x30,
 156                  0x13,0x10, 
 157                  0x12,0x10,0x13,0x10,0x15,0x10,0x18,0x10,0x18,0x20,
 158          
 159                  0x1c,0x10,0x18,0x10,0x15,0x10,0x15,0x20,0x13,0x10,0x13,0x30,
 160                  0x13,0x10, 
 161                  0x10,0x10,0x0e,0x10,0x15,0x10,0x18,0x10,0x13,0x20,
 162                  0x1c,0x10,0x18,0x10,                      
 163                  0x12,0x20,0x13,0x20,0x15,0x20,0x18,0x20,0x15,0x10,0x13,0x10,0x19,0x10,
 164                  0x20,0x10,0x1c,0x20,
 165                  0x1c,0x10,0x18,0x10,0x15,0x10,0x15,0x20,0x13,0x10,0x13,0x30,0x13,0x10,
 166                  0x10,0x10,
 167                  0x0e,0x10,0x15,0x10,0x18,0x10,0x13,0x20,
 168                  0x1c,0x10,0x18,0x10,0x15,0x10,0x15,0x20,0x13,0x10,0x13,0x30,
 169                  0x13,0x10, 
 170                  0x12,0x10,0x13,0x10,0x15,0x10,0x18,0x10,0x18,0x20,
 171          
 172                  0x1c,0x10,0x18,0x10,0x15,0x10,0x15,0x20,0x13,0x10,0x13,0x30,
 173                  0x13,0x10, 
 174                  0x10,0x10,0x0e,0x10,0x15,0x10,0x18,0x10,0x13,0x20,
 175                  0x1c,0x10,0x18,0x10,                      
 176                  0x12,0x20,0x13,0x20,0x15,0x20,0x18,0x20,
 177                  0x15,0x10,0x18,0x10,0x12,0x10,0x10,0x10,0x0e,0x80,    
 178          
C51 COMPILER V9.00   千本樱（改）                                                          12/30/2018 20:31:07 PAGE 4   

 179                  0x00 
 180          }               ;
 181          
 182          
 183          
 184          
 185          
 186          
 187          
 188          void int0()  interrupt 1      
 189          {  TH0=0xd8;   
 190   1      TL0=0xef;   
 191   1      n--;   
 192   1      }   
 193          
 194          void delay (unsigned char m)      
 195          {   
 196   1              unsigned i=3*m;   
 197   1              while(--i);   
 198   1      }   
 199          
 200          void delayms(unsigned char a)  
 201          {   
 202   1              while(--a);               
 203   1      }                                                                                                                
 204          
 205          
 206          
 207          
 208          
 209          
 210          
 211          
 212          
 213          
 214          
 215          
 216          
 217          
 218          
 219          
 220          void main()   
 221          {
 222   1              unsigned char p,m;    
 223   1              unsigned char i=0;   
 224   1              TMOD&=0x0f;   
 225   1              TMOD|=0x01;   
 226   1              TH0=0xd8;TL0=0xef;   
 227   1              IE=0x82;
 228   1              while(1)
 229   1              {       
 230   2                      if(k1==0)                 //检测按键K1是否按下
 231   2                      {       
 232   3                              delay(1000);   //消除抖动 一般大约10ms
 233   3                              if(k1==0)        //再次判断按键是否按下
 234   3                              {
 235   4                                      goto play;        //led状态取反
 236   4                              }
 237   3                              while(!k1);      //检测按键是否松开
 238   3                      }               
 239   2              }   
 240   1      play:   
C51 COMPILER V9.00   千本樱（改）                                                          12/30/2018 20:31:07 PAGE 5   

 241   1      while(1)   
 242   1      {
 243   2      
 244   2      
 245   2      a: p=music_tab[i];   
 246   2              if(p==0x00)       { i=0, delayms(1000); goto b;}     
 247   2              else if(p==0xff)  { i=i+1;delayms(100),TR0=0; goto a;}      
 248   2              else         {m=music_tab[i++], n=music_tab[i++];}      
 249   2              TR0=1;                                                 
 250   2              while(n!=0) Beep=~Beep,delay(m);                           
 251   2              TR0=0; 
 252   2              goto a   ;
 253   2      b: p=music_tab1[i];   
 254   2              if(p==0x00)       { i=0, delayms(1000); goto c;}     
 255   2              else if(p==0xff)  { i=i+1;delayms(10),TR0=0; goto b;}      
 256   2              else         {m=music_tab1[i++], n=music_tab1[i++];}      
 257   2              TR0=1;                                                 
 258   2              while(n!=0) Beep=~Beep,delay(m);                           
 259   2              TR0=0;   
 260   2              goto b ;
 261   2      c: p=music_tab2[i];   
 262   2              if(p==0x00)       { i=0, delayms(1000); goto d;}     
 263   2              else if(p==0xff)  { i=i+1;delayms(100),TR0=0; goto c;}      
 264   2              else         {m=music_tab2[i++], n=music_tab2[i++];}      
 265   2              TR0=1;                                                 
 266   2              while(n!=0) Beep=~Beep,delay(m);                           
 267   2              TR0=0;   
 268   2              goto c;
 269   2      d: p=music_tab3[i];   
 270   2              if(p==0x00)       { i=0, delayms(1000); goto stop;}     
 271   2              else if(p==0xff)  { i=i+1;delayms(100),TR0=0; goto d;}      
 272   2              else         {m=music_tab3[i++], n=music_tab3[i++];}      
 273   2              TR0=1;                                                 
 274   2              while(n!=0) Beep=~Beep,delay(m);                           
 275   2              TR0=0;     
 276   2              goto d;                               
 277   2      }  
 278   1      stop :
 279   1      while(1)
 280   1      {}
 281   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    306    ----
   CONSTANT SIZE    =    754    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
